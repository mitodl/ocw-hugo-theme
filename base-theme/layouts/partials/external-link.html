{{- $text := default .title .text | htmlEscape | page.RenderString -}}
{{- $isImage := default false .is_image -}}
{{- $href := default "" .external_url -}}

{{- if and .is_broken .backup_url -}}
  {{- $href = .backup_url -}}
{{- end -}}

{{- if $isImage -}}
  <img src="{{- $href -}}" alt="{{- $text -}}" />
{{- else -}}
  {{ partial "link" (dict "href" $href "text" $text "class" .class) }}
{{- end -}}
