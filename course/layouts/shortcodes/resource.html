{{- $uuid := index .Params 0 -}}
{{- $imageHref := "" -}}
{{- range $.Site.Pages -}}
  {{- if eq (replace .Params.uid "-" "") (replace $uuid "-" "") -}}
    {{- if eq .Params.resourcetype "Image" -}}

      {{- if .Params.href_uuid -}}
        {{- range where $.Site.Pages "Params.uid" .Params.href_uuid -}}
          {{ $imageHref = .Permalink }}
        {{- end -}}
      {{- end -}}

      {{- if .Params.href -}}
        {{$imageHref = .Params.href }}
      {{- end -}}

      {{- if $imageHref -}}
        <a href="{{ $imageHref }}" target="_blank">
      {{- end -}}
        {{- $metadata := .Params.image_metadata | default dict -}}
        <img src="{{ partial "resource_url" .Params.file }}" {{ if index $metadata "image-alt" -}}alt="{{ index $metadata "image-alt" }}"{{- end }} />
      {{- if $imageHref -}}
        </a>
      {{- end -}}

    {{- else if eq .Params.resourcetype "Video" -}}
      {{ partial "video_embed.html" . }}
    {{- else -}}
      <a href="{{ partial "resource_url" .Params.file }}">{{ .Params.title }}</a>
    {{- end -}}
  {{- end -}}
{{- end -}}
