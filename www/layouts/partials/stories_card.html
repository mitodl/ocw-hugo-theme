{{$testimonial := .testimonial}}
{{$jsurls := .jsurls}}
{{$context := .context | default "carousel"}}
<div class="h-100">
    <div class="testimonial d-flex flex-column rounded h-100">
      <div class="testimonial-image-wrapper" style="margin-bottom: 20px">
        <img 
          src="{{ partial "resource_url.html" (dict "context" . "url" (partial "resource_metadata.html" $testimonial.Params.image.content).Params.file) }}" 
          alt="{{ $testimonial.Title }}" 
          class="testimonial-image"
        >
      </div>
      <div class="testimonial-title {{if $testimonial.Params.is_quote}}quote{{ end }}" style="padding: 0px 20px; margin-bottom: 20px">
        <div class="name font-weight-bold" style="font-size: 20px; margin-bottom: 10px;">
          {{ $testimonial.Title }}
        </div>
        <div class="occupation-wrapper d-flex justify-content-between">
          <div class="occupation">
            {{ $testimonial.Params.occupation }}
          </div>
          <div class="occupation-location">
            {{ $testimonial.Params.location }}
          </div>
        </div>
      </div>
      <div class="{{ if not $testimonial.Params.is_quote}}story-body{{ else }}quote-body{{ end }}{{if eq $context "carousel"}} carousel{{else}}modal{{end}} d-flex flex-column justify-content-between h-100" style="padding: 0px 20px 20px 20px">
        <div class="content {{ if eq $context "carousel" }}testimonial-carousel{{ else }}testimonial-modal{{ end }}">
         {{ $testimonial.Content | plainify | replaceRE "\\s+" " " }}
        </div>
        {{ if and (eq $testimonial.Params.is_quote true) (eq $context "carousel") }}
          <div>
            <span style="color:#0A3E56">Read Full Quote</span>
          </div>
        {{ else if not $testimonial.Params.is_quote }}
          <div>
            <span style="color:#0A3E56">Read Full Story</span>
          </div>
        {{ end }}
      </div>
    </div>
</div>
