{{ define "main" }}
{{- $story := . -}}

<div class="single-container">
  {{ block "header" . }}
  {{ partialCached "header" . }}
  {{ end }}
  
  <div class="testimonial-single navbar">
    <div class="testimonials w-100 standard-width mx-auto">
      <a href="/stories" class="view-all-stories-left-btn text-decoration-none d-inline-flex align-items-center">
        <img
          class="view-all-stories-left-arrow"
          src="{{ partial "get_asset_webpack_url.html" "images/ocw_story_single_arrow_left.svg" }}"
          alt=""
        />
        <h1>OCW Stories</h1>
      </a>
      
      <div class="testimonial standard-width mx-auto d-flex align-items-center">
        <div style="max-width: 200px;">
          <div class="img-container single-testimonial-page">
            <img
              src="{{ partial "resource_url.html" (dict "context" . "url" (partial "resource_metadata.html" $story.Params.image.content).Params.file) }}"
              alt=""
            />
          </div>
        </div>
        <div class="detail d-flex flex-column flex-nowrap justify-content-center" style="margin-left: 30px;">
          <div class="text">
            <h2 style="margin-bottom: 20px; font-size: 30px; font-weight: 700;">{{ $story.Title }}</h2>
            <p style="margin-bottom: 20px; font-weight: 400;">
              {{ $story.Params.occupation }} | {{ $story.Params.location }}
            </p>
            <p class="summarys mb-0 pb-0" style="font-size: 18px; color: var(--Primary, #03152D); font-weight: 700;">
              "{{ $story.Params.leadquote }}"
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="container standard-width mx-auto mt-5 mb-5">
    <div class="row">
      <div class="full-testimonial pt-5 pb-3 col-md-8">
        {{ .Content }}
      </div>
      <!-- Sidebar -->
      <div class="col-md-4">
        <div class="more-stories">
          <h3>More Stories</h3>
          <div class="flex-nowrap justify-content-center">
            {{ range $index, $testimonial := first 3 (where .Site.RegularPages "Type" "==" "stories") }}
              <a 
                data-modal-content-id="modal-content-{{ $index }}" 
                class="item-wrapper d-block testimonial-link {{if $testimonial.Params.is_quote}}js-modal-trigger{{end}} text-decoration-none" 
                {{ if $testimonial.Params.is_quote }} 
                  href="#" 
                  data-toggle="modal" 
                  data-target="#exampleModalCenter"
                {{ else }} 
                  href="{{ $testimonial.RelPermalink }}" 
                {{ end }}
              >
                {{ partial "stories_card.html" (dict "testimonial" $testimonial "index" $index) }}
              </a>
              <div id="modal-content-{{ $index }}" class="hidden-modal-content">
                {{ partial "stories_card.html" (dict "testimonial" $testimonial "context" "modal") }}
              </div>
            {{ end }}
          </div>
          <div>
            <a href="/stories" class="btn view-all-stories px-4 py-3 text-decoration-none d-flex justify-content-center align-items-center w-100">
              View All OCW Stories
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
  {{ block "footer" . }} {{ partialCached "footer" . }} {{end}}
</div>

{{ partial "quotes_modal.html" }}
{{ end }}
