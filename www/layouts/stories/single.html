{{ define "main" }}
{{- $story := . -}}

<div>
  {{ block "header" . }}
  {{ partialCached "header" . }}
  {{ end }}
  
  <div class="header-bar bg-secondary py-2 mb-4">
    <h1 class="text-white text-center">OCW Stories</h1>
  </div>
  <div class="testimonial-single navbar navbar-light bg-light">
    <div class="testimonials w-100 standard-width mx-auto">
      <a href="/stories" class="view-all-stories-left-btn text-decoration-none d-inline-flex align-items-center" style="font-weight: 600;">
        <img
          class="view-all-stories-left-arrow"
          src="{{ partial "get_asset_webpack_url.html" "images/ocw_story_single_arrow_left.svg" }}"
          alt=""
          style="margin-right:10px;"
        />
        <h1 style="margin: 0; font-size: 35px">OCW Stories</h1>
      </a>
      
      <div class="testimonial standard-width mx-auto d-flex align-items-center">
        <div style="max-width: 180px; width: 100%;">
          <div class="img-container single-testimonial-page">
            <img
              src="{{ partial "resource_url.html" (dict "context" . "url" (partial "resource_metadata.html" $story.Params.image.content).Params.file) }}"
              alt=""
              style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover;"
            />
          </div>
        </div>
        <div class="detail d-flex flex-column flex-nowrap justify-content-center" style="margin-left: 30px;">
          <div class="text">
            <h2 style="margin-bottom: 20px; font-size: 30px; font-weight: 700;">{{ $story.Title }}</h2>
            <p style="margin-bottom: 20px; font-weight: 400;">
              {{ $story.Params.occupation }} | {{ $story.Params.location }}
            </p>
            <p class="summarys mb-0 pb-0" style="font-size: 18px; color: var(--Primary, #03152D); font-weight: 700;">
              "{{ $story.Params.leadquote }}"
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="standard-width mx-auto mt-5 mb-5">
    <div class="row">
      <div class="full-testimonial pt-5 pb-3 col-md-8">
        {{ .Content }}
      </div>
      <!-- Sidebar -->
      <div class="col-md-4">
        <div>
          <h3 class="mb-4">More Stories</h3>
          <div class="flex-nowrap justify-content-center">
            {{ range $index, $testimonial := first 3 (where .Site.RegularPages "Type" "==" "stories") }}
              <a 
                data-modal-content-id="modal-content-{{ $index }}" 
                class="item-wrapper d-block testimonial-link {{if $testimonial.Params.is_quote}}js-modal-trigger{{end}}" 
                style="flex: 1 1; padding:10px; margin-left: 10px;" 
                {{ if $testimonial.Params.is_quote }} 
                  href="#" 
                  data-toggle="modal" 
                  data-target="#exampleModalCenter"
                {{ else }} 
                  href="{{ $testimonial.RelPermalink }}" 
                {{ end }}
              >
                {{ partial "stories_card.html" (dict "testimonial" $testimonial "index" $index) }}
              </a>
              <div id="modal-content-{{ $index }}" style="display: none;">
                {{ partial "stories_card.html" (dict "testimonial" $testimonial "context" "modal") }}
              </div>
            {{ end }}
          </div>
          <div class="d-flex justify-content-center mt-4">
            <a href="/stories" class="btn px-4 py-3 text-decoration-none d-flex align-items-center" style="padding: 15px 20px; border-radius: 3px; border: 1px solid var(--Border-Grey, #DFE5EC); background: var(--white-mit-brand, #FFF); font-weight: 600; color:#03152D;">
              View All OCW Stories
              <img
                class="ml-2"
                src="{{ partial "get_asset_webpack_url.html" "images/ocw_stories_btn_arrow_right.svg" }}"
                alt=""
              />
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
  {{ block "footer" . }} {{ partialCached "footer" . }} {{end}}
</div>

<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" style="max-width: 600px" role="document">
    <div class="modal-content">
      <div class="modal-body" style="padding: 10px;">
      </div>
    </div>
  </div>
</div>

<script>
  window.addEventListener("load", function () {
    if (window.initModalHandler) {
      window.initModalHandler();
    }
  });
</script>
{{ end }}
