{{ $url := .menuItem.URL }}
{{ $noHttpPrefix := not (strings.HasPrefix $url "http") }}
{{ $noHtmlSuffix := not (strings.HasSuffix $url ".html") }}
{{ if and $noHttpPrefix $noHtmlSuffix }}
  {{ $relativePathToRoot := partial "relative_path_to_root.html" (dict "url" .context.RelPermalink) }}
  {{ $trimmedUrl := strings.TrimPrefix "/" (strings.TrimSuffix "/" .menuItem.URL) }}
  {{ $url = printf "%s%s/index.html" $relativePathToRoot $trimmedUrl }}
{{ end }}
{{ return $url }}
